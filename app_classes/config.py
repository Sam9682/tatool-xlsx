import logging

logger = logging.getLogger(__name__)


class Config(object):

    def default_json_dict(self):
        default_trend_values_dictionary = {
            'isSuppressed': {
                'global_error': [['2017-10-10', 0, 0],
                                 ['2017-10-11', 0, 0],
                                 ['2017-10-12', 0, 0],
                                 ['2017-10-13', 0, 0],
                                 ['2017-10-14', 0, 0],
                                 ['2017-10-15', 0, 0],
                                 ['2017-10-16', 0, 0],
                                 ['2017-10-17', 0, 0],
                                 ['2017-10-18', 0, 0],
                                 ['2017-10-19', 0, 0],
                                 ['2017-10-20', 0, 0],
                                 ['2017-10-21', 0, 0]],
                'mfa_on_root_account' : [['2017-10-10', 0],
                                 ['2017-10-11', 0],
                                 ['2017-10-12', 0],
                                 ['2017-10-13', 0],
                                 ['2017-10-14', 0],
                                 ['2017-10-15', 0],
                                 ['2017-10-16', 0],
                                 ['2017-10-17', 0],
                                 ['2017-10-18', 0],
                                 ['2017-10-19', 0],
                                 ['2017-10-20', 0],
                                 ['2017-10-21', 0]],
                'no_backend_ELB': [['2017-10-10', 0],
                                        ['2017-10-11', 0],
                                        ['2017-10-12', 0],
                                        ['2017-10-13', 0],
                                        ['2017-10-14', 0],
                                        ['2017-10-15', 0],
                                        ['2017-10-16', 0],
                                        ['2017-10-17', 0],
                                        ['2017-10-18', 0],
                                        ['2017-10-19', 0],
                                        ['2017-10-20', 0],
                                        ['2017-10-21', 0]],
                'ELB_sg_problems': [['2017-10-10', 0, 0],
                                 ['2017-10-11', 0, 0],
                                 ['2017-10-12', 0, 0],
                                 ['2017-10-13', 0, 0],
                                 ['2017-10-14', 0, 0],
                                 ['2017-10-15', 0, 0],
                                 ['2017-10-16', 0, 0],
                                 ['2017-10-17', 0, 0],
                                 ['2017-10-18', 0, 0],
                                 ['2017-10-19', 0, 0],
                                 ['2017-10-20', 0, 0],
                                 ['2017-10-21', 0, 0]],
                'IAM_access_key_rotation': [['2017-10-10', 0, 0],
                                            ['2017-10-11', 0, 0],
                                            ['2017-10-12', 0, 0],
                                            ['2017-10-13', 0, 0],
                                            ['2017-10-14', 0, 0],
                                            ['2017-10-15', 0, 0],
                                            ['2017-10-16', 0, 0],
                                            ['2017-10-17', 0, 0],
                                            ['2017-10-18', 0, 0],
                                            ['2017-10-19', 0, 0],
                                            ['2017-10-20', 0, 0],
                                            ['2017-10-21', 0, 0]],
                'IAM_password_policy': [['2017-10-10', 0, 0],
                                        ['2017-10-11', 0, 0],
                                        ['2017-10-12', 0, 0],
                                        ['2017-10-13', 0, 0],
                                        ['2017-10-14', 0, 0],
                                        ['2017-10-15', 0, 0],
                                        ['2017-10-16', 0, 0],
                                        ['2017-10-17', 0, 0],
                                        ['2017-10-18', 0, 0],
                                        ['2017-10-19', 0, 0],
                                        ['2017-10-20', 0, 0],
                                        ['2017-10-21', 0, 0]],
                'RDS_idle_db_connection_14_plus': [['2017-10-10', 0],
                                               ['2017-10-11', 0],
                                               ['2017-10-12', 0],
                                               ['2017-10-13', 0],
                                               ['2017-10-14', 0],
                                               ['2017-10-15', 0],
                                               ['2017-10-16', 0],
                                               ['2017-10-17', 0],
                                               ['2017-10-18', 0],
                                               ['2017-10-19', 0],
                                               ['2017-10-20', 0],
                                               ['2017-10-21', 0]],
                'RDS_no_backups': [['2017-10-10', 0],
                                   ['2017-10-11', 0],
                                   ['2017-10-12', 0],
                                   ['2017-10-13', 0],
                                   ['2017-10-14', 0],
                                   ['2017-10-15', 0],
                                   ['2017-10-16', 0],
                                   ['2017-10-17', 0],
                                   ['2017-10-18', 0],
                                   ['2017-10-19', 0],
                                   ['2017-10-20', 0],
                                   ['2017-10-21', 0]],
                'RDS_sg_risk': [['2017-10-10', 0, 0],
                                ['2017-10-11', 0, 0],
                                ['2017-10-12', 0, 0],
                                ['2017-10-13', 0, 0],
                                ['2017-10-14', 0, 0],
                                ['2017-10-15', 0, 0],
                                ['2017-10-16', 0, 0],
                                ['2017-10-17', 0, 0],
                                ['2017-10-18', 0, 0],
                                ['2017-10-19', 0, 0],
                                ['2017-10-20', 0, 0],
                                ['2017-10-21', 0, 0]],
                'S3_bucket_logging': [['2017-10-10', 0, 0, 0],
                                      ['2017-10-11', 0, 0, 0],
                                      ['2017-10-12', 0, 0, 0],
                                      ['2017-10-13', 0, 0, 0],
                                      ['2017-10-14', 0, 0, 0],
                                      ['2017-10-15', 0, 0, 0],
                                      ['2017-10-16', 0, 0, 0],
                                      ['2017-10-17', 0, 0, 0],
                                      ['2017-10-18', 0, 0, 0],
                                      ['2017-10-19', 0, 0, 0],
                                      ['2017-10-20', 0, 0, 0],
                                      ['2017-10-21', 0, 0, 0]],
                'S3_bucket_permissions': [['2017-10-10', 0, 0],
                                          ['2017-10-11', 0, 0],
                                          ['2017-10-12', 0, 0],
                                          ['2017-10-13', 0, 0],
                                          ['2017-10-14', 0, 0],
                                          ['2017-10-15', 0, 0],
                                          ['2017-10-16', 0, 0],
                                          ['2017-10-17', 0, 0],
                                          ['2017-10-18', 0, 0],
                                          ['2017-10-19', 0, 0],
                                          ['2017-10-20', 0, 0],
                                          ['2017-10-21', 0, 0]],
                'S3_bucket_versioning': [['2017-10-10', 0],
                                         ['2017-10-11', 0],
                                         ['2017-10-12', 0],
                                         ['2017-10-13', 0],
                                         ['2017-10-14', 0],
                                         ['2017-10-15', 0],
                                         ['2017-10-16', 0],
                                         ['2017-10-17', 0],
                                         ['2017-10-18', 0],
                                         ['2017-10-19', 0],
                                         ['2017-10-20', 0],
                                         ['2017-10-21', 0]],
            },
            'unfiltered': {
                'global_error': [['2017-10-10', 0, 0],
                                 ['2017-10-11', 0, 0],
                                 ['2017-10-12', 0, 0],
                                 ['2017-10-13', 0, 0],
                                 ['2017-10-14', 0, 0],
                                 ['2017-10-15', 0, 0],
                                 ['2017-10-16', 0, 0],
                                 ['2017-10-17', 0, 0],
                                 ['2017-10-18', 0, 0],
                                 ['2017-10-19', 0, 0],
                                 ['2017-10-20', 0, 0],
                                 ['2017-10-21', 0, 0]],
                'mfa_on_root_account' : [['2017-10-10', 0],
                                 ['2017-10-11', 0],
                                 ['2017-10-12', 0],
                                 ['2017-10-13', 0],
                                 ['2017-10-14', 0],
                                 ['2017-10-15', 0],
                                 ['2017-10-16', 0],
                                 ['2017-10-17', 0],
                                 ['2017-10-18', 0],
                                 ['2017-10-19', 0],
                                 ['2017-10-20', 0],
                                 ['2017-10-21', 0]],
                'no_backend_ELB': [['2017-10-10', 0],
                                    ['2017-10-11', 0],
                                    ['2017-10-12', 0],
                                    ['2017-10-13', 0],
                                    ['2017-10-14', 0],
                                    ['2017-10-15', 0],
                                    ['2017-10-16', 0],
                                    ['2017-10-17', 0],
                                    ['2017-10-18', 0],
                                    ['2017-10-19', 0],
                                    ['2017-10-20', 0],
                                    ['2017-10-21', 0]],
                'ELB_sg_problems': [['2017-10-10', 0, 0],
                                    ['2017-10-11', 0, 0],
                                    ['2017-10-12', 0, 0],
                                    ['2017-10-13', 0, 0],
                                    ['2017-10-14', 0, 0],
                                    ['2017-10-15', 0, 0],
                                    ['2017-10-16', 0, 0],
                                    ['2017-10-17', 0, 0],
                                    ['2017-10-18', 0, 0],
                                    ['2017-10-19', 0, 0],
                                    ['2017-10-20', 0, 0],
                                    ['2017-10-21', 0, 0]],
                'IAM_access_key_rotation': [['2017-10-10', 0, 0],
                                            ['2017-10-11', 0, 0],
                                            ['2017-10-12', 0, 0],
                                            ['2017-10-13', 0, 0],
                                            ['2017-10-14', 0, 0],
                                            ['2017-10-15', 0, 0],
                                            ['2017-10-16', 0, 0],
                                            ['2017-10-17', 0, 0],
                                            ['2017-10-18', 0, 0],
                                            ['2017-10-19', 0, 0],
                                            ['2017-10-20', 0, 0],
                                            ['2017-10-21', 0, 0]],
                'IAM_password_policy': [['2017-10-10', 0, 0],
                                        ['2017-10-11', 0, 0],
                                        ['2017-10-12', 0, 0],
                                        ['2017-10-13', 0, 0],
                                        ['2017-10-14', 0, 0],
                                        ['2017-10-15', 0, 0],
                                        ['2017-10-16', 0, 0],
                                        ['2017-10-17', 0, 0],
                                        ['2017-10-18', 0, 0],
                                        ['2017-10-19', 0, 0],
                                        ['2017-10-20', 0, 0],
                                        ['2017-10-21', 0, 0]],
                'RDS_idle_db_connection_14_plus': [['2017-10-10', 0],
                                               ['2017-10-11', 0],
                                               ['2017-10-12', 0],
                                               ['2017-10-13', 0],
                                               ['2017-10-14', 0],
                                               ['2017-10-15', 0],
                                               ['2017-10-16', 0],
                                               ['2017-10-17', 0],
                                               ['2017-10-18', 0],
                                               ['2017-10-19', 0],
                                               ['2017-10-20', 0],
                                               ['2017-10-21', 0]],
                'RDS_no_backups': [['2017-10-10', 0],
                                   ['2017-10-11', 0],
                                   ['2017-10-12', 0],
                                   ['2017-10-13', 0],
                                   ['2017-10-14', 0],
                                   ['2017-10-15', 0],
                                   ['2017-10-16', 0],
                                   ['2017-10-17', 0],
                                   ['2017-10-18', 0],
                                   ['2017-10-19', 0],
                                   ['2017-10-20', 0],
                                   ['2017-10-21', 0]],
                'RDS_sg_risk': [['2017-10-10', 0, 0],
                                ['2017-10-11', 0, 0],
                                ['2017-10-12', 0, 0],
                                ['2017-10-13', 0, 0],
                                ['2017-10-14', 0, 0],
                                ['2017-10-15', 0, 0],
                                ['2017-10-16', 0, 0],
                                ['2017-10-17', 0, 0],
                                ['2017-10-18', 0, 0],
                                ['2017-10-19', 0, 0],
                                ['2017-10-20', 0, 0],
                                ['2017-10-21', 0, 0]],
                'S3_bucket_logging': [['2017-10-10', 0, 0, 0],
                                      ['2017-10-11', 0, 0, 0],
                                      ['2017-10-12', 0, 0, 0],
                                      ['2017-10-13', 0, 0, 0],
                                      ['2017-10-14', 0, 0, 0],
                                      ['2017-10-15', 0, 0, 0],
                                      ['2017-10-16', 0, 0, 0],
                                      ['2017-10-17', 0, 0, 0],
                                      ['2017-10-18', 0, 0, 0],
                                      ['2017-10-19', 0, 0, 0],
                                      ['2017-10-20', 0, 0, 0],
                                      ['2017-10-21', 0, 0, 0]],
                'S3_bucket_permissions': [['2017-10-10', 0, 0],
                                          ['2017-10-11', 0, 0],
                                          ['2017-10-12', 0, 0],
                                          ['2017-10-13', 0, 0],
                                          ['2017-10-14', 0, 0],
                                          ['2017-10-15', 0, 0],
                                          ['2017-10-16', 0, 0],
                                          ['2017-10-17', 0, 0],
                                          ['2017-10-18', 0, 0],
                                          ['2017-10-19', 0, 0],
                                          ['2017-10-20', 0, 0],
                                          ['2017-10-21', 0, 0]],
                'S3_bucket_versioning': [['2017-10-10', 0],
                                         ['2017-10-11', 0],
                                         ['2017-10-12', 0],
                                         ['2017-10-13', 0],
                                         ['2017-10-14', 0],
                                         ['2017-10-15', 0],
                                         ['2017-10-16', 0],
                                         ['2017-10-17', 0],
                                         ['2017-10-18', 0],
                                         ['2017-10-19', 0],
                                         ['2017-10-20', 0],
                                         ['2017-10-21', 0]],
            },
            'filtered': {
                'global_error': [['2017-10-10', 0, 0],
                                 ['2017-10-11', 0, 0],
                                 ['2017-10-12', 0, 0],
                                 ['2017-10-13', 0, 0],
                                 ['2017-10-14', 0, 0],
                                 ['2017-10-15', 0, 0],
                                 ['2017-10-16', 0, 0],
                                 ['2017-10-17', 0, 0],
                                 ['2017-10-18', 0, 0],
                                 ['2017-10-19', 0, 0],
                                 ['2017-10-20', 0, 0],
                                 ['2017-10-21', 0, 0]],
                'mfa_on_root_account' : [['2017-10-10', 0],
                                 ['2017-10-11', 0],
                                 ['2017-10-12', 0],
                                 ['2017-10-13', 0],
                                 ['2017-10-14', 0],
                                 ['2017-10-15', 0],
                                 ['2017-10-16', 0],
                                 ['2017-10-17', 0],
                                 ['2017-10-18', 0],
                                 ['2017-10-19', 0],
                                 ['2017-10-20', 0],
                                 ['2017-10-21', 0]],
                'no_backend_ELB': [['2017-10-10', 0],
                                    ['2017-10-11', 0],
                                    ['2017-10-12', 0],
                                    ['2017-10-13', 0],
                                    ['2017-10-14', 0],
                                    ['2017-10-15', 0],
                                    ['2017-10-16', 0],
                                    ['2017-10-17', 0],
                                    ['2017-10-18', 0],
                                    ['2017-10-19', 0],
                                    ['2017-10-20', 0],
                                    ['2017-10-21', 0]],
                'ELB_sg_problems': [['2017-10-10', 0, 0],
                                    ['2017-10-11', 0, 0],
                                    ['2017-10-12', 0, 0],
                                    ['2017-10-13', 0, 0],
                                    ['2017-10-14', 0, 0],
                                    ['2017-10-15', 0, 0],
                                    ['2017-10-16', 0, 0],
                                    ['2017-10-17', 0, 0],
                                    ['2017-10-18', 0, 0],
                                    ['2017-10-19', 0, 0],
                                    ['2017-10-20', 0, 0],
                                    ['2017-10-21', 0, 0]],
                'IAM_access_key_rotation': [['2017-10-10', 0, 0],
                                    ['2017-10-11', 0, 0],
                                    ['2017-10-12', 0, 0],
                                    ['2017-10-13', 0, 0],
                                    ['2017-10-14', 0, 0],
                                    ['2017-10-15', 0, 0],
                                    ['2017-10-16', 0, 0],
                                    ['2017-10-17', 0, 0],
                                    ['2017-10-18', 0, 0],
                                    ['2017-10-19', 0, 0],
                                    ['2017-10-20', 0, 0],
                                    ['2017-10-21', 0, 0]],
                'IAM_password_policy': [['2017-10-10', 0, 0],
                                            ['2017-10-11', 0, 0],
                                            ['2017-10-12', 0, 0],
                                            ['2017-10-13', 0, 0],
                                            ['2017-10-14', 0, 0],
                                            ['2017-10-15', 0, 0],
                                            ['2017-10-16', 0, 0],
                                            ['2017-10-17', 0, 0],
                                            ['2017-10-18', 0, 0],
                                            ['2017-10-19', 0, 0],
                                            ['2017-10-20', 0, 0],
                                            ['2017-10-21', 0, 0]],
                'RDS_idle_db_connection_14_plus': [['2017-10-10', 0],
                                   ['2017-10-11', 0],
                                   ['2017-10-12', 0],
                                   ['2017-10-13', 0],
                                   ['2017-10-14', 0],
                                   ['2017-10-15', 0],
                                   ['2017-10-16', 0],
                                   ['2017-10-17', 0],
                                   ['2017-10-18', 0],
                                   ['2017-10-19', 0],
                                   ['2017-10-20', 0],
                                   ['2017-10-21', 0]],
                'RDS_no_backups': [['2017-10-10', 0],
                                                   ['2017-10-11', 0],
                                                   ['2017-10-12', 0],
                                                   ['2017-10-13', 0],
                                                   ['2017-10-14', 0],
                                                   ['2017-10-15', 0],
                                                   ['2017-10-16', 0],
                                                   ['2017-10-17', 0],
                                                   ['2017-10-18', 0],
                                                   ['2017-10-19', 0],
                                                   ['2017-10-20', 0],
                                                   ['2017-10-21', 0]],
                'RDS_sg_risk': [['2017-10-10', 0, 0],
                                ['2017-10-11', 0, 0],
                                ['2017-10-12', 0, 0],
                                ['2017-10-13', 0, 0],
                                ['2017-10-14', 0, 0],
                                ['2017-10-15', 0, 0],
                                ['2017-10-16', 0, 0],
                                ['2017-10-17', 0, 0],
                                ['2017-10-18', 0, 0],
                                ['2017-10-19', 0, 0],
                                ['2017-10-20', 0, 0],
                                ['2017-10-21', 0, 0]],
                'S3_bucket_logging': [['2017-10-10', 0, 0, 0],
                                ['2017-10-11', 0, 0, 0],
                                ['2017-10-12', 0, 0, 0],
                                ['2017-10-13', 0, 0, 0],
                                ['2017-10-14', 0, 0, 0],
                                ['2017-10-15', 0, 0, 0],
                                ['2017-10-16', 0, 0, 0],
                                ['2017-10-17', 0, 0, 0],
                                ['2017-10-18', 0, 0, 0],
                                ['2017-10-19', 0, 0, 0],
                                ['2017-10-20', 0, 0, 0],
                                ['2017-10-21', 0, 0, 0]],
                'S3_bucket_permissions': [['2017-10-10', 0, 0],
                                ['2017-10-11', 0, 0],
                                ['2017-10-12', 0, 0],
                                ['2017-10-13', 0, 0],
                                ['2017-10-14', 0, 0],
                                ['2017-10-15', 0, 0],
                                ['2017-10-16', 0, 0],
                                ['2017-10-17', 0, 0],
                                ['2017-10-18', 0, 0],
                                ['2017-10-19', 0, 0],
                                ['2017-10-20', 0, 0],
                                ['2017-10-21', 0, 0]],
                'S3_bucket_versioning': [['2017-10-10', 0],
                                                   ['2017-10-11', 0],
                                                   ['2017-10-12', 0],
                                                   ['2017-10-13', 0],
                                                   ['2017-10-14', 0],
                                                   ['2017-10-15', 0],
                                                   ['2017-10-16', 0],
                                                   ['2017-10-17', 0],
                                                   ['2017-10-18', 0],
                                                   ['2017-10-19', 0],
                                                   ['2017-10-20', 0],
                                                   ['2017-10-21', 0]],
            }
        }
        return default_trend_values_dictionary

    def check_trend_dict_updated(self, json_trends_dict):
        default_trend_values_dictionary = self.default_json_dict()
        logging.info("Checking if the trend dictionary is updated with current checks...")
        if len(default_trend_values_dictionary.get('unfiltered').keys()) != len(json_trends_dict.get('unfiltered').keys()):
            logging.warning("Default trend log / Current application trend log mismatch found! Updating the new features.")
            json_trends_dict = self.update_trend_dict_with_default_keys(json_trends_dict)
        else: logging.info("Trend log file updated to the current level of features.")
        return json_trends_dict

    def update_trend_dict_with_default_keys(self, json_trends_dict):
        default_trend_values_dictionary = self.default_json_dict()
        for key in default_trend_values_dictionary['unfiltered']:
            if key not in json_trends_dict.get('unfiltered'):
                json_trends_dict['unfiltered'][key] = default_trend_values_dictionary['unfiltered'][key]
                json_trends_dict['filtered'][key] = default_trend_values_dictionary['filtered'][key]
                json_trends_dict['isSuppressed'][key] = default_trend_values_dictionary['isSuppressed'][key]
                logging.warning("Updated the new trend info %s", key)
        return json_trends_dict